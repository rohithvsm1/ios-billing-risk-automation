name: iOS Build CI/CD (SIMPLEST)
on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build-ios:
    runs-on: macos-15
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Build iOS App (No derivedDataPath)
      run: |
        xcodebuild build \
          -project InvoiceRiskDetector.xcodeproj \
          -sdk iphonesimulator \
          -configuration Debug \
          -arch arm64
    
    - name: Find Built App
      run: |
        echo "=== SEARCHING FOR .app FILES ==="
        find . -name "*.app" -type d | head -5
    
    - name: List Build Products
      run: |
        ls -la **/Debug-iphonesimulator/ 2>/dev/null || echo "No Debug folder"
    
    - name: Upload Any Artifacts
      uses: actions/upload-artifact@v4
      if: always()
      with:
        name: ios-build-output
        path: |
          **/*.app
          **/Debug-iphonesimulator/
